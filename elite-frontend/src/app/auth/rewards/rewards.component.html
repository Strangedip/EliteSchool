<div class="rewards-container">
  <div class="rewards-header">
    <h1 class="rewards-title">Rewards Center</h1>
    <p class="rewards-subtitle">Manage your rewards and view transaction history</p>
  </div>

  <div class="rewards-grid">
    <!-- Wallet Balance Card -->
    <div class="card wallet-card">
      <div class="card-body">
        <div class="card-header-flex">
          <h2 class="card-title">
            <i class="pi pi-wallet"></i> 
            Wallet Balance
          </h2>
          <button class="balance-toggle" (click)="toggleBalanceVisibility()">
            <i class="pi" [ngClass]="showBalance ? 'pi-eye-slash' : 'pi-eye'"></i>
          </button>
        </div>
        
        <div *ngIf="loading" class="loading-indicator">
          <i class="pi pi-spin pi-spinner"></i>
          <span>Loading balance...</span>
        </div>
        
        <div *ngIf="!loading" class="balance-display">
          <div class="balance" [class.blur-text]="!showBalance">
            {{ showBalance ? walletBalance : '••••' }} 
            <span class="points-label">points</span>
          </div>
          <p class="balance-info">Use your points to redeem rewards in the store</p>
        </div>
        
        <div class="card-actions">
          <a routerLink="/auth/store" class="btn-primary">
            <i class="pi pi-shopping-cart"></i> Go to Store
          </a>
        </div>
      </div>
    </div>

    <!-- Activity Summary Card -->
    <div class="card stats-card">
      <div class="card-body">
        <h2 class="card-title">
          <i class="pi pi-chart-line"></i> 
          Activity Summary
        </h2>
        
        <div *ngIf="transactionLoading" class="loading-indicator">
          <i class="pi pi-spin pi-spinner"></i>
          <span>Loading stats...</span>
        </div>
        
        <div *ngIf="!transactionLoading" class="stats-grid">
          <div class="stat-item">
            <span class="stat-value earned">+{{ getTotalEarnedPoints() }}</span>
            <span class="stat-label">Points Earned</span>
          </div>
          <div class="stat-item">
            <span class="stat-value spent">-{{ getTotalSpentPoints() }}</span>
            <span class="stat-label">Points Spent</span>
          </div>
          <div class="stat-item">
            <span class="stat-value">{{ transactions.length }}</span>
            <span class="stat-label">Transactions</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Transaction History -->
    <div class="card transactions-card">
      <div class="card-header">
        <h2>Transaction History</h2>
        
        <!-- View Mode Filter -->
        <div class="filter-controls">
          <button 
            class="filter-btn" 
            [class.active]="viewMode === 'all'"
            (click)="setViewMode('all')">
            All
          </button>
          <button 
            class="filter-btn" 
            [class.active]="viewMode === 'earned'"
            (click)="setViewMode('earned')">
            Earned
          </button>
          <button 
            class="filter-btn" 
            [class.active]="viewMode === 'spent'"
            (click)="setViewMode('spent')">
            Spent
          </button>
        </div>
      </div>
      
      <div class="card-body">
        <div *ngIf="transactionLoading" class="loading-indicator">
          <i class="pi pi-spin pi-spinner"></i>
          <span>Loading transactions...</span>
        </div>
        
        <div *ngIf="!transactionLoading && getFilteredTransactions().length === 0" class="empty-state">
          <i class="pi pi-history empty-icon"></i>
          <p>No transactions found</p>
        </div>
        
        <div *ngIf="!transactionLoading && getFilteredTransactions().length > 0" class="transaction-list">
          <div class="transaction-table-header">
            <div class="th type-col">Type</div>
            <div class="th points-col">Points</div>
            <div class="th desc-col">Description</div>
            <div class="th date-col">Date</div>
          </div>
          
          <div class="transaction-item" *ngFor="let transaction of getFilteredTransactions()">
            <div class="transaction-cell type-col">
              <div class="transaction-type">
                <i class="pi" [ngClass]="transaction.transactionType === 'EARNED' ? 'pi-plus-circle' : 'pi-minus-circle'"
                  [class.earned]="transaction.transactionType === 'EARNED'"
                  [class.spent]="transaction.transactionType === 'SPENT'"></i>
                <span>{{ transaction.transactionType }}</span>
              </div>
            </div>
            <div class="transaction-cell points-col" [ngClass]="transaction.transactionType === 'EARNED' ? 'earned' : 'spent'">
              {{ formatPoints(transaction) }}
            </div>
            <div class="transaction-cell desc-col">{{ transaction.description }}</div>
            <div class="transaction-cell date-col">{{ formatDate(transaction.createdAt) }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 