<div class="profile-container" *ngIf="user">
    <div class="profile-header">
        <div class="user-avatar">
            <i class="pi pi-user"></i>
        </div>
        <div class="user-info">
            <h2>{{ user.name }}</h2>
            <p class="user-role">{{ user.role }}</p>
            <p class="user-email">{{ user.email }}</p>
        </div>
        <div class="elite-points" *ngIf="user.role === 'STUDENT'">
            <div class="points-badge">
                <i class="pi pi-star"></i>
                <span class="points-value">{{ rewardPoints }}</span>
            </div>
            <span class="points-label">Elite Points</span>
        </div>
    </div>

    <div class="profile-content">
        <div class="profile-tabs">
            <p-tabView>
                <p-tabPanel header="Personal Information">
                    <div class="personal-info">
                        <div class="info-section">
                            <h3>Account Details</h3>
                            <div class="info-row">
                                <span class="info-label">Elite ID:</span>
                                <span class="info-value">{{ user.eliteId }}</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">Username:</span>
                                <span class="info-value">{{ user.username }}</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">Email:</span>
                                <span class="info-value">{{ user.email }}</span>
                            </div>
                            <div class="info-row" *ngIf="user.mobileNumber">
                                <span class="info-label">Mobile:</span>
                                <span class="info-value">{{ user.mobileNumber }}</span>
                            </div>
                        </div>

                        <div class="info-section" *ngIf="user.role === 'STUDENT'">
                            <h3>Student Information</h3>
                            <!-- Show student-specific information here -->
                        </div>

                        <div class="info-section" *ngIf="user.role === 'FACULTY'">
                            <h3>Faculty Information</h3>
                            <!-- Show faculty-specific information here -->
                        </div>
                    </div>
                </p-tabPanel>

                <p-tabPanel header="Rewards History" *ngIf="user.role === 'STUDENT'">
                    <div class="rewards-history">
                        <h3>Transaction History</h3>
                        <p-table [value]="transactions" [paginator]="true" [rows]="10" styleClass="p-datatable-striped">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Type</th>
                                    <th>Points</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-transaction>
                                <tr>
                                    <td>{{ formatDate(transaction.createdAt) }}</td>
                                    <td>{{ transaction.description }}</td>
                                    <td>
                                        <span class="transaction-badge" [ngClass]="transaction.transactionType === 'EARNED' ? 'earned' : 'spent'">
                                            {{ transaction.transactionType }}
                                        </span>
                                    </td>
                                    <td>
                                        <span [ngClass]="{'positive': transaction.transactionType === 'EARNED', 'negative': transaction.transactionType === 'SPENT'}">
                                            {{ transaction.transactionType === 'EARNED' ? '+' : '-' }} {{ transaction.points }}
                                        </span>
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="4" style="text-align: center;">
                                        No transactions found
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </p-tabPanel>

                <p-tabPanel header="Tasks" *ngIf="user.role === 'STUDENT'">
                    <div class="student-tasks">
                        <h3>Your Tasks</h3>
                        <p-table [value]="userTasks" [paginator]="true" [rows]="10" styleClass="p-datatable-striped">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th>Title</th>
                                    <th>Status</th>
                                    <th>Submitted On</th>
                                    <th>Reward Points</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-task>
                                <tr>
                                    <td>{{ task.title }}</td>
                                    <td>
                                        <span class="task-status-badge" [ngClass]="task.status.toLowerCase()">
                                            {{ task.status }}
                                        </span>
                                    </td>
                                    <td>{{ formatDate(task.submittedAt || '') }}</td>
                                    <td>{{ task.rewardPoints }}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="4" style="text-align: center;">
                                        No tasks found
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </p-tabPanel>
            </p-tabView>
        </div>
    </div>
</div>
